#!/usr/bin/python

import ConfigParser
import logging
import ssl

from common import operations

LOG = logging.getLogger(__name__)
CONFIG_FILE_PATH = '/usr/local/data/config.ini'


def main():
    try:
        _create_unverified_https_context = ssl._create_unverified_context
    except AttributeError:
        # Legacy Python that doesn't verify HTTPS certificates by default
        pass
    else:
        # Handle target environment that doesn't support HTTPS verification
        ssl._create_default_https_context = _create_unverified_https_context

    cf = ConfigParser.ConfigParser()
    cf.read(CONFIG_FILE_PATH)

    vc = operations.get_vcenter(cf)
    dc = operations.get_datacenter(vc, cf)
    operations.add_hosts_to_cluster(vc, dc, cf)
    operations.config_hosts(vc, cf)
    operations.create_dvs(vc, dc, cf)
    operations.add_nfs_to_host(vc, cf)


if __name__ == '__main__':
    main()
